<th:block th:include="@{my/_header.html}"/>
<script type="text/javascript">
$(function(){
	let today = new Date();
	let month = today.getMonth()+1;
	for(let i = 0; i < month; i++){
		let tag = "<li>";
			tag += "<a th:href='@{#}' class='sort' data-sort='"+i+"'>";
			tag += "<em>"+(month-i)+"</em>월";
			tag += "</a>";
			tag += "</li>";
		$(".date_5ea").append(tag);
	};
	
	$(".sort").click(function(e){
		e.preventDefault();
		let sort = $(this).data("sort");
		let uid = $("input[name=uid]").val();
		let pg = $("input[name=pg]").val();
		let json = {
				"sort":sort,
				"uid":uid,
				"pg":pg,
		}
		$.ajax({
			url:"/Kmarket2/my/pointBySort",
			method:"get",
			data:json,
			dataType:"json",
			success:function(data){
				$(".pts").remove();
				for(let item of data.points){
					let tag = "<tr class='pts'>";
						tag += "<td class='date'>"+item.pointDate.substring(2,10)+"</td>";
						if(item.type == 0){
							tag += "<td class='type'>적립</td>";
						}else if(item.type == 1){
							tag += "<td class='type'>사용</td>";
						}else if(item.type == 2){
							tag += "<td class='type'>만료</td>";
						}
						tag += "<td class='ordNo'>"+item.ordNo+"</td>";
						tag += "<td class='point'>"+item.point+"</td>";
						tag += "<td class='desc'>"+item.desc+"</td>";
						tag += "<td class='expire'>"+item.expiration.substring(2,10)+"</td>"
						tag += "</tr>"
					$(".ptsTable").append(tag);
				}
				
			}
		})
	});
});
</script>
            <div class="point">
                <th:block th:include="@{my/_side.html}"/>
                <section>
                    <a href="#">
                        <img src="../img/my_banner2.png" alt="패션, 타운 하나로 끝" class="banner">
                    </a>
                    <article>
                        <h3>포인트내역</h3>
                        <input type="hidden" name="uid" th:value="${uid}">
                        <input type="hidden" name="pg" th:value="${pg}">
                        <div class="byDate">
                            <span class="tit">기간별조회</span>
                            <ul class="date_3ea">
                                <li>
                                    <a class="sort" th:href="@{#}" data-sort="5">
                                        <em>1</em>주일
                                    </a>
                                </li>
                                <li>
                                    <a class="sort" th:href="@{#}" data-sort="6">
                                        <em>15</em>일
                                    </a>
                                </li>
                                <li>
                                    <a th:href="@{#}" class="sort on" data-sort="7">
                                        <em>1</em>개월
                                    </a>
                                </li>
                            </ul>
                            <ul class="date_5ea">
                                <!-- 
                                	<li>
                                    <a th:href="@{#}">
                                        <em>1</em>월
                                    </a>
                                </li>
                                 -->
                            </ul>
                            <p>
                                <input type="date" name="begin">
                                <span>~</span>
                                <input type="date" name="end">
                            </p>
                            <button class="btnConfirm">조회하기</button>
                        </div>
                        <table border="0" class="ptsTable">
                            <tr>
                                <th>날짜</th>
                                <th>구분</th>
                                <th>주문번호</th>
                                <th>적립금액</th>
                                <th>비고</th>
                                <th>유효기간</th>
                            </tr>
                            <tr th:each="item : ${points}" class="pts">
                                <td class="date">[[${item.pointDate.substring(2,10)}]]</td>
                                <td class="type" th:if="${item.type}==0">적립</td>
                                <td class="type" th:if="${item.type}==1">사용</td>
                                <td class="type" th:if="${item.type}==2">만료</td>
                                <td class="ordNo">[[${item.ordNo}]]</td>
                                <td class="point">[[${item.point}]]</td>
                                <td class="desc">[[${item.desc}]]</td>
                                <td class="expire">[[${item.expiration.substring(2,10)}]]</td>
                            </tr>
                        </table>
                        <p class="page" th:if="${!#lists.isEmpty(points)}">
                        	<th:block th:if="${pageGroupStart > 1}">
                            	<a th:href="@{/my/point(pg=${currentPage - 1})}" class="prev">이전</a>
                            </th:block>
                            <th:block th:each="num : ${#numbers.sequence(pageGroupStart, pageGroupEnd)}">
                            	<a th:href="@{/my/point(pg=${num},group='review')}" th:class="${num} eq ${currentPage} ? 'num on':'num'">[[${num}]]</a>
                            </th:block>
                            <th:block th:if="${pageGroupEnd < lastPageNum}">
                            <a th:href="@{/my/point(pg=${currentPage+ 1})}" class="next">다음</a>
                            </th:block>
                        </p>
                    </article>
                </section>
            </div>
<th:block th:include="@{my/_footer.html}"/>
    </div>
</body>
</html>